# ✦ Mystic Tarot ✦

인터랙티브 타로카드 리딩 웹 애플리케이션

![License](https://img.shields.io/badge/license-MIT-blue)
![Platform](https://img.shields.io/badge/platform-GitHub%20Pages-brightgreen)
![Cards](https://img.shields.io/badge/deck-78%20cards-gold)

---

## 📋 프로젝트 개요

Canvas 기반의 인터랙티브 타로카드 점술 웹앱입니다.
Rider-Waite-Smith 덱 78장(메이저 아르카나 22장 + 마이너 아르카나 56장)을 사용하며,
Google Gemini AI(gemini-2.5-flash)를 통한 자동 해석 기능을 제공합니다.

GitHub Pages에 배포 가능한 **Static HTML** 프로젝트로,
별도의 서버나 빌드 과정 없이 바로 사용할 수 있습니다.

---

## 🗂️ 프로젝트 구조

```
mystic-tarot/
├── index.html              # 메인 HTML (페이지 구조, 102줄)
├── css/
│   └── style.css           # 스타일시트 (반응형 포함, 653줄)
├── js/
│   └── app.js              # 메인 애플리케이션 로직 (1,148줄)
├── data/
│   ├── deck.json           # 78장 타로카드 데이터 (이미지 URL, 정/역방향 의미)
│   └── spreads.json        # 6종 스프레드 정의 (위치명, 카드 수)
└── README.md               # 프로젝트 문서
```

---

## 🃏 주요 기능

### 타로 리딩 (메인 페이지)

- **대기 화면 애니메이션**
  - 12장의 랜덤 카드가 3D 타원 궤도를 따라 회전 (앞면/뒷면 자동 플립)
  - 수정구슬: 유리 구체 안에 보라색/금색 연기가 소용돌이치며 피어오름
  - 아지랑이(Heat-Haze) 효과: 수정구슬 위로 빛 파티클과 광선 줄기가 흔들리며 상승
  - 별빛 + 성운 배경 렌더링
- **매시 셔플 애니메이션**: 흩뿌리기 → 3회 원형 워시 → 모으기 → 쌓기
- **호 모양 스프레드**: 28장의 카드가 부채꼴로 펼쳐져 선택 대기
- **카드 부유(Floating) 효과**: 각 카드가 고유 위상으로 상하좌우 부유 (사인파 기반)
  - 동적 그림자 깊이 변화
  - 골드 글로우 펄스 효과
- **리빌 애니메이션**: 선택 완료 후 카드가 확대되어 부채꼴 배치
  - 6장 이상은 자동 2행 레이아웃
  - 카드 아래에 위치명 · 카드명 · 정/역방향 라벨 표시
  - 결과 패널이 캔버스 하단에 슬라이드업
- 정방향 / 역방향 랜덤 적용 (50% 확률)
- Gemini AI를 이용한 카드 해석 (API 키 미입력 시 기본 해석 표시)

### 설정 페이지

- **Gemini AI API Key**: 입력 및 브라우저 저장 (localStorage)
- **스프레드 선택**: 6종 스프레드 중 택 1 (브라우저 저장)

### 타로 내역 페이지

- 과거 리딩 기록 목록 (최대 50건)
- 날짜, 스프레드명, 질문, 선택 카드 표시
- 클릭 시 상세 내역: 200×330px 대형 카드 이미지 + AI 해석 재확인

---

## 🎴 타로 덱 구성

| 분류 | 장수 | 구성 |
|------|------|------|
| **메이저 아르카나** | 22장 | The Fool(0) ~ The World(21) |
| **마이너 — Wands** | 14장 | Ace ~ King of Wands |
| **마이너 — Cups** | 14장 | Ace ~ King of Cups |
| **마이너 — Swords** | 14장 | Ace ~ King of Swords |
| **마이너 — Pentacles** | 14장 | Ace ~ King of Pentacles |
| **합계** | **78장** | 메이저 + 마이너 전체 사용 |

- 이미지 출처: Wikimedia Commons (Public Domain, Pamela Colman Smith, 1909)
- 정방향 / 역방향 의미 한국어 제공

---

## 🔮 스프레드 종류

| 스프레드 | 카드 수 | 설명 |
|----------|---------|------|
| **원 카드** | 1장 | 현재 메시지 |
| **쓰리 카드** | 3장 | 과거 → 현재 → 미래 |
| **켈트 십자가** | 10장 | 상황, 도전, 과거, 미래, 자아, 환경, 희망, 결과 등 |
| **생명의 나무** | 10장 | 카발라 세피로트 기반 (케테르 ~ 말쿠트) |
| **말 발굽** | 7장 | 과거, 현재, 미래, 행동, 영향, 장애물, 결과 |
| **보름달** | 6장 | 에너지, 욕구, 외부, 무의식, 의식, 통합 |

---

## ✨ 시각 효과 상세

### 대기 화면

| 효과 | 설명 |
|------|------|
| **3D 카드 궤도** | 12장이 타원 궤도를 따라 공전, `cos(angle)` 기반 앞/뒤 플립 + 원근 스케일 |
| **수정구슬** | 유리 구체(어두운 내부 그라데이션) + 상단 좌측 하이라이트 + 림 라이트 |
| **내부 연기** | 18개 소용돌이 파티클(보라·금) + 6개 상승 텐드릴 |
| **아지랑이** | 14개 Heat-Haze 파티클(금·백·보라) — 위로 흔들리며 상승·소멸 |
| **광선 줄기** | 5개 수직 Light Pillar — 가늘고 긴 빛기둥이 깜빡이며 상승 |
| **별빛 배경** | 50개 미세 별 + 맥동하는 성운 그라데이션 |

### 카드 인터랙션

| 효과 | 설명 |
|------|------|
| **부유(Float)** | 사인파 기반 상하좌우 이동 + 미세 회전 + 스케일 펄스 |
| **동적 그림자** | 부유 높이에 비례하는 그림자 깊이·블러 |
| **골드 글로우** | 뒤집힌 카드 테두리의 맥동하는 금색 빛 |
| **호버 효과** | 8px 리프트 + 1.08× 확대 + 골드 보더 |
| **리빌 감쇠** | 결과 화면에서는 부유 강도가 35%로 감소 → 안정적 디스플레이 |

---

## 🛠️ 기술 스택

| 항목 | 기술 |
|------|------|
| **마크업** | HTML5 (시맨틱 구조) |
| **스타일** | CSS3 (커스텀 프로퍼티, clamp(), 반응형, Backdrop Filter) |
| **렌더링** | JavaScript Canvas 2D API |
| **애니메이션** | requestAnimationFrame (60fps 연속 루프) |
| **AI 해석** | Google Gemini API (gemini-2.5-flash) |
| **데이터** | JSON (fetch API → Promise.all 비동기 병렬 로드) |
| **저장소** | localStorage (API 키, 스프레드 설정, 히스토리 최대 50건) |
| **배포** | GitHub Pages (Static, 서버리스) |

---

## 📱 반응형 지원

| 화면 | 카드 크기(CSS 변수) | 네비게이션 높이 |
|------|---------------------|----------------|
| **모바일** (≤480px) | 62×108px | 50px |
| **태블릿** (≥768px) | 110×191px | 56px |
| **데스크탑** (≥1200px) | 120×209px (최대 900px 중앙) | 56px |

---

## 🚀 배포 방법

### GitHub Pages

1. 저장소에 전체 파일을 푸시합니다
2. Settings → Pages → Source를 `main` 브랜치로 설정합니다
3. `https://<username>.github.io/<repo>/` 에서 접속 가능합니다

### 로컬 실행

JSON 파일을 fetch로 불러오기 때문에 로컬 서버가 필요합니다:

```bash
# Python 3
python -m http.server 8000

# Node.js (npx)
npx serve .

# VS Code의 Live Server 확장 사용
```

브라우저에서 `http://localhost:8000` 으로 접속합니다.

> ⚠️ `file://` 프로토콜로 직접 열면 CORS 정책으로 JSON 로딩이 차단됩니다.

---

## ⚙️ Gemini AI 설정

1. [Google AI Studio](https://aistudio.google.com/)에서 API 키를 발급받습니다
2. 앱의 **설정** 페이지에서 API 키를 입력 → 저장합니다
3. 키는 브라우저 localStorage에 저장되며 외부 서버로 전송되지 않습니다

API 키가 없어도 기본 카드 의미 해석으로 사용 가능합니다.

---

## 📄 데이터 구조

### deck.json

```json
{
  "baseUrl": "https://upload.wikimedia.org/wikipedia/commons/",
  "cards": [
    {
      "id": "m0",
      "name": "The Fool",
      "img": "9/90/RWS_Tarot_00_Fool.jpg",
      "type": "major",
      "meaning": "새로운 시작, 모험, 자유",
      "reversed": "무모함, 방향 상실, 경솔"
    }
  ]
}
```

- `baseUrl` + `img` 조합으로 전체 이미지 URL 생성
- `meaning`: 정방향 의미 (한국어)
- `reversed`: 역방향 의미 (한국어)
- 셔플 시 `isReversed` 불리언 플래그가 별도 부여됨

### spreads.json

```json
{
  "three": {
    "name": "쓰리 카드",
    "nameEn": "Three Card",
    "count": 3,
    "positions": ["과거", "현재", "미래"]
  }
}
```

---

## 🎮 사용자 흐름

```
[대기 화면]
  수정구슬 + 카드 궤도 애니메이션
       ↓ 셔플 버튼 클릭
[셔플 애니메이션]
  흩뿌리기 → 워시 3회 → 모으기 → 쌓기
       ↓
[카드 스프레드]
  28장 부채꼴 배치 → 카드 선택 (N장)
       ↓ 필요한 카드 수 선택 완료
[리빌 애니메이션]
  선택 카드 확대 배치 + 라벨 + AI 해석 패널
       ↓ 닫기 / 다시 뽑기
[대기 화면으로 복귀]
```

---

## 📌 개발 히스토리

| 버전 | 변경 내용 |
|------|-----------|
| v1 | 78장 RWS 덱 + 쓰리 카드 스프레드 기본 구현 |
| v2 | Wikimedia Commons 이미지 URL 검증 (Nine of Wands, The Lovers 파일명 수정) |
| v3 | 매시 셔플 애니메이션 + 호 모양 스프레드 연출 |
| v4 | 6종 스프레드 확장, Gemini AI 해석, 히스토리, 설정 페이지 |
| v5 | 카드 부유(Floating) 연출: 사인파 기반 움직임, 동적 그림자, 별빛 배경 |
| v6 | 파일 분리 (HTML / CSS / JS / JSON), fetch 기반 데이터 로드 |
| v7 | Gemini API → gemini-2.5-flash 업그레이드, 역방향 확률 50%, The Lovers 이미지 수정 |
| v8 | 대기 화면: 수정구슬 + 랜덤 카드 3D 궤도 + 아지랑이 Heat-Haze 효과 |
| v9 | 리빌 시스템: 캔버스 내 확대 카드 배치 + 2행 레이아웃 + 결과 패널 인라인화 |
| v10 | 겹침 방지: 패널 우선 표시 → 리사이즈 → 레이아웃 계산, 히스토리 카드 200×330px |

---

## 📜 라이선스

- **코드**: MIT License
- **카드 이미지**: Public Domain (Pamela Colman Smith, 1909, Wikimedia Commons)
